<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0" name="viewport">
    <title>RRM RCA - MSA</title>
	
	<script type="text/javascript" src="js/RRM_RCA_area_intervention.js"></script>
	<script type="text/javascript" src="js/RRM_RCA_admin1.js"></script>

    <!-- Bootstrap -->
	
	<script src="js/html5.js"></script>
	
    <link type="text/css" rel="stylesheet" href="css/bootstrap.css">
    <link type="text/css" href="css/leaflet.css" rel="stylesheet"/>
    <link type="text/css" href="css/leaflet.markercluster.css" rel="stylesheet"/>

    <link rel="stylesheet" type="text/css" href="css/dc.css">
    <!-- Add IntroJs styles  -->
    <link rel="stylesheet" type="text/css" href="css/introjs.css">
    <link rel="stylesheet" type="text/css" href="css/dashboard.css">
    <link rel="stylesheet" type="text/css" href="css/colorbrewer.css">

    <link href="font-awesome-4.1.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	

<style>
/* Change the styles below in order to customize your template */

body{font-family: Helvetica, Arial; font-weight: regular; font-size: 15px; color: #555; background-color: #FFF; margin: 0;}
h1{font-weight: bold; font-size: 31px; letter-spacing: -1px; color: #333; line-height: 33px;}
h3{font-weight: bold; font-size: 20px; color: #fff; text-transform: uppercase; margin: 5px 0 0 0;}
h3a{font-weight: bold; font-size: 12px; color: #fff;  margin: 20px 0 0 0;}
h4a {   color:#505050; font-size: 12px; margin: 5px 0 0 0;}
h4{font-weight: bold; font-size: 12px; color: #000; margin: 10px 0 0 10px;line-height:14px}
h5{font-size: 10px;font-style:italic; color: #000; margin: 0px 0px 0px 10px; line-height:10px}
p{margin: 8px 0 20px 0; line-height: 18px;}
a, a:visited{color: #397DB8; text-decoration: none;}
a:hover{text-decoration: underline;}

.wrapper{display: block; margin: 0px 0 0 0; padding: 4px 30px 0 30px;}

.map{background-color:#eee; position: absolute; top: 50px; left: 0; bottom: 0; width: 50%; *height:100%;}
.sidepanel{background-color:#b6b6b6; position: absolute; top: 50px; right: 0;  bottom: 0; width: 50%; *height: 100%; overflow: auto}

.context{font-family: Helvetica, Arial; font-size: 13px; color: #999; padding: 10px 0 0 0;}
.subheader{border-bottom: 1px solid #ddd;}
.footer{border-top: 1px solid #ddd; margin-top: 30px;}
.titleBlock{text-align: right;
/* Here are the styles that makes the template responsive*/
@media only screen and (max-width: 768px) {
  .map{position: inherit; height: 400px; width: 100%; display: block;}
  .sidepanel{position: inherit; width: 100%;}
}
@media only screen and (max-width: 480px) {
  .map {height: 300px;}
}
.bar rect {
  shape-rendering: crispEdges;
}
.bar text {
  text-anchor: end;
}
.axis path,
.axis line {
  fill: none;
  stroke: #000;
  shape-rendering: crispEdges;
}
</style>

</head>
 <body>
  <nav class="navbar navbar-inverse navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">RRM République Centrafricaine</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Type d'activités <span class="caret"></span></a>
			  
               <ul class="dropdown-menu" role="menu">
					 <li><a href="alerte.html">Alertes</a></li>
					<li><a href="mex.html">MEX (Missions Exploratoires)</a></li>
					<li><a href="MSA.html">MSA (Evaluations Multisectorielles)</a></li>
					<li><a href="inter.html">Interventions</a></li>
					<li><a href="pdm.html">PDM</a></li>
					<li><a href="acceshum.html">Accès humanitaire</a></li>
					<li><a href="plaidoyer.html">Plaidoyer</a></li>
					<li><a href="reference_2014.html">Carte de référence 2014</a></li>
					<li><a href="reference_2015.html">Carte de référence 2015</a></li>
					<li><a href="reference_2016.html">Carte de référence 2016</a></li>
              </ul>
            </li>
			<li><a href="index.html">Acceuil</a></li>
			<li><a class="reset" id="reset" href="#"><button>Réinitialiser</button></a></li>
			</ul>
			<ul class="nav navbar-nav navbar-right">
			<li style="top:12px"><img src="image/unicef-logo.png" width="125" height="25"style="border-width:0px;"><li>	
			<li><a> </a></li>
			<li style="top:7px"><img src="image/rrm.png" width="129" height="37"style="border-width:0px;"><li>	
			<li><a> </a></li>
			<li style="top:12px"><img src="image/REACH_logo.png" width="129" height="29"style="border-width:0px;"><li>					
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>   
	
   <div style="display: block;"  id="dashboard">
             <div class="row" id="cccm">
                <div  class="map" id="cccm"  > </div>

                <div class="sidepanel">
					<div class="wrapper">
						  
						<div class="row">
							<div  class="col-md-8">
							<h3>MSA - Evaluations Multisectorielles </h3>
							</div>
							<div  class="col-md-4" align="right">
							<h3a><br>Dernière actualisation: 12 janvier 2016</h3a>
							</div>
						</div> 
						<div class="row">
							<div  class="col-md-12" align="justify">
							<h4a><br>Bienvenue sur la page du tableau de bord interactif RRM. Cliquez sur les différents éléments pour sélectionner les informations qui vous intéressent.<br> Pour revenir au début et réinitialiser les filtres, cliquez sur <b>« Réinitialiser »</b>. </h4a>
							</div>
						</div> 		
						<div class="row">
							<div  class="col-md-2">
								<div  class="nombre" id="cccm" class="dc-chart"></div>
							</div>
						</div>
											
						<div class="row">
							<div  class="col-md-4">
								<div  class="pref" id="cccm" class="dc-chart">
								  <h4>Nombre de MSA</h4><h5>par préfecture</h5>
								</div>
							</div>
							
							<div  class="col-md-4">
								<div  class="prefpop" id="cccm" class="dc-chart">
										<h4>IDPs affectés</h4><h5>par préfecture (k = 1000)</h5>
								</div>
								
							</div>
							<div  class="col-md-4">
								<div  class="Partner" id="cccm" class="dc-chart"><h4>Nombre de MSA effectuées</h4><h5>par partenaires</h5/></div>
							</div>
							 
						</div>
						<div class="row">
							<div  class="col-md-1"></div>
							<div  class="col-md-4">
								<div  class="year" id="cccm" class="dc-chart">
								     <h4>Nombre de MSA effectuées par an</h4>
								</div>
							</div>
							<div  class="col-md-1">
								<!--<div  class="Status" id="cccm" class="dc-chart"><h4>Nombre de MSA par status </h4></div>-->
							</div>
							<div  class="col-md-4">
								<div  class="SCORE_NFI" id="cccm" class="dc-chart">
								  <h4>Score NFI moyen par village</h4><h5>Nombre de Villages</h5>
								</div>
								
							</div>
						</div>
						
						 <div class="row">
							  <div  class="col-md-4">
								<div  class="FCS_poor" id="cccm" class="dc-chart">
									<h4>Nombre de villages par pourcentage de la population avec un score SCA Pauvre**</h4>
								</div>
								
							  </div>
							  <div  class="col-md-4">
								<div  class="FCS_borderline" id="cccm" class="dc-chart">
								     <h4>Nombre de villages par pourcentage de la population avec un score SCA Limite**</h4>
								</div>
							</div>
							 <div  class="col-md-4">
								<div  class="FCS_acceptable" id="cccm" class="dc-chart">
								     <h4>Nombre de villages par pourcentage de la population avec un score SCA Acceptable**</h4>
								</div>
							</div>
						</div>	  
						 <div class="row">
							  <div  class="col-md-4">
								<div  class="water" id="cccm" class="dc-chart">
									<h4>Nombre de villages par pourcentage de la population ayant accès à une eau de qualité ameliorée</h4>
								</div>
							  </div>
							  <div  class="col-md-4">
								<div  class="latrine" id="cccm" class="dc-chart">
								     <h4>Nombre de villages par pourcentage de la population ayant accès à une latrine ameliorée</h4>
								</div>
							</div>
							  <div  class="col-md-4">
								<div  class="abris" id="cccm" class="dc-chart">
								     <h4>Nombre de villages par pourcentage de la population vivant dans un abris correspondant aux standards minimums</h4>
								</div>
							</div>
						</div>	
						<div class="row">
								<div class="col-md-7"><h4>Proposition d'action</br> </br></h4/>	
										<div class="row-fluid">
											<div  class="col-md-4">
													  <div class="proMSADIV" id="#cccm" class="dc-chart"  ><h6>Intervention</br>NFI</br></h6/></div>
											</div>
											<div  class="col-md-4">
													  <div class="pr_dirDIV" id="#cccm" class="dc-chart"  ><h6>Intervention</br>WASH</br></h6/></div>
											</div>
											<div  class="col-md-4">					 
													  <div class="pro_accDIV"  id="#cccm"  class="dc-chart"><h6>Pas d'intervention</br></br></h6/></div>
											</div>
										</div>
										<div class="row-fluid">	
											<div  class="col-md-4">
													  <div class="protDIV" id="#cccm" class="dc-chart" ><h6>Intervention</br>protection</br></h6/></div>
											</div>
											<div  class="col-md-4">
													  <div class="dispDIV" id="#cccm" class="dc-chart"><h6>Intervention</br>Santé/Nutrition</br></h6/></div>
											</div>
											<div  class="col-md-4">
													  <div class="pr_sectDIV" id="#cccm" class="dc-chart"><h6>Intervention</br>Securité Alimentaire</br></h6/></div>
											</div>
										</div>	
										<div class="row-fluid">
											<div  class="col-md-4">
													  <div class="pr_logDIV" id="#cccm" class="dc-chart"><h6>Intervention</br>Education</br></h6/></div>
											</div>
											<div  class="col-md-4">
													  <div class="pr_PasActionDIV" id="#cccm" class="dc-chart"><h6>Intervention</br>Logistique</br></h6/></div>
											</div>
											<!--<div  class="col-md-4">
													  <div class="pr_AutreDIV" id="#cccm" class="dc-chart"><h6>Intervention</br>Logistique</br><</h6/></div>
											</div>-->
										</div>	
								</div>
								<div  class="col-md-5">
											<div  class="PropAction" id="cccm" class="dc-chart"><h4>Proposition d'action</h4><h5>Nombre de propositions reportées</h5></br></div>
											<div Class ="PropAction1" id="cccm" class="dc-chart"></div>
										    <div  class="PropAction2" id="cccm" class="dc-chart"></div>
											<div  class="PropAction3" id="cccm" class="dc-chart"></div>
											<div  class="PropAction4" id="cccm" class="dc-chart"></div>
											<div  class="PropAction5" id="cccm" class="dc-chart"></div>
											<div  class="PropAction6" id="cccm" class="dc-chart"></div>
											<div  class="PropAction7" id="cccm" class="dc-chart"></div>
											<div  class="PropAction8" id="cccm" class="dc-chart"></div>
											
								</div>
						 </div>	
						<!--<div class="row">	  
								
									<div  class="col-md-6">
										   <div Class ="CauseInt1" id="cccm" class="dc-chart"><h4>Cause internes de délais</h4><h5>Nombre de causes reportées</h5></div>
										    <div  class="CauseInt2" id="cccm" class="dc-chart"></div>
											<div  class="CauseInt3" id="cccm" class="dc-chart"></div>
											<div  class="CauseInt4" id="cccm" class="dc-chart"></div>
											<div  class="CauseInt5" id="cccm" class="dc-chart"></div>
											<div  class="CauseInt6" id="cccm" class="dc-chart"></div>
									</div>
								
								
									<div  class="col-md-6">
										   <div Class ="CauseExt1" id="cccm" class="dc-chart"><h4>Causes externes de délais</h4><h5>Nombre de causes reportées</h5></div>
										   <div  class="CauseExt2" id="cccm" class="dc-chart"></div>
											<div  class="CauseExt3" id="cccm" class="dc-chart"></div>
											<div  class="CauseExt4" id="cccm" class="dc-chart"></div>
											<div  class="CauseExt5" id="cccm" class="dc-chart"></div>
											<div  class="CauseExt6" id="cccm" class="dc-chart"></div>
											<div  class="CauseExt7" id="cccm" class="dc-chart"></div>
											<div  class="CauseExt8" id="cccm" class="dc-chart"></div>
											<div  class="CauseExt9" id="cccm" class="dc-chart"></div>
														
							
									</div>
								
						</div>	-->
						
						<div class="row">
							<div  class="col-md-8">
							   <div Class ="start_dates" id="cccm" class="dc-lineChart">
								  <h4>Nombre de MSA effectuées</h4><h5>Selectionner le graphique pour filtrer par date</h5>
								</div>
							</div>	
							 
						</div>
						<div class="row">
							 <div  class="col-md-12">
							 <h5>* Score NFI: score basé sur la possession des principaux produits non alimentaires, un score élevé indique un déficit de ces principaux produits</h5>	
							<h5>** SCA ou Score de consommation alimentaire est un index composite basé sur la diversité de l'alimentation, la fréquence d'absorption et l'apport nutritionnel des différents groupes alimentaires. Cet index est divisé en trois groupes (pauvre, limite et acceptable)</h5></br></br>
							</div>
						</div>
					</div>
                </div>
            </div>
			
        </div>
    </div>

    <script type="text/javascript" src="js/intro.js"></script>
    <script type="text/javascript" src="js/d3_002.js"></script>
    <script type="text/javascript" src="js/d3.js"></script>
    <script type="text/javascript" src="js/crossfilter.js"></script>
    <script type="text/javascript" src="js/dc.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
<!--maps-->
    <script type="text/javascript" src="js/leaflet.js"></script>
	<<script type="text/javascript"  src="js/esri-leaflet.js"></script>
    <script type="text/javascript" src="js/leaflet.markercluster.js"></script>
    <script type="text/javascript" src="js/dc.leaflet_msa.js"></script>
    <script type="text/javascript" src="js/colorbrewer.js"></script>

<script type="text/javascript">

/*     Markers      */

d3.csv("data/RRM_MSA.csv", function(error,data) {
	 
     drawMarkerArea(data);
});


function regroup(dim, cols) {
    var _groupAll = dim.groupAll().reduce(
        function(p, v) { // add
            cols.forEach(function(c) {
                p[c] += v[c];
            });
            return p;
        },
        function(p, v) { // remove
            cols.forEach(function(c) {
                p[c] -= v[c];
            });
            return p;
        },
        function() { // init
            var p = {};
            cols.forEach(function(c) {
                p[c] = 0;
            });
            return p;
        });
    return {
        all: function() {
            return d3.map(_groupAll.value()).entries();
        }
    };
}


function drawMarkerArea(data) {

	var dateFormat = d3.time.format("%d.%m.%Y");
    data.forEach(function (d) {
	d.DD  = dateFormat.parse(d.startDate)
	//d.year = d3.time.year(d.DD)
	d.month= d3.time.month(d.DD)
	});
	


  var xf = crossfilter(data);

  var groupname = "marker-select";

  var facilities = xf.dimension(function(d) { return d.Latitude+","+d.Longitude; });
  var facilitiesGroup = facilities.group();
  
  dc.leafletMarkerChart(".map",groupname)
      .dimension(facilities)
      .group(facilitiesGroup)
      .width(900)
      //.height(300)
      .center([6.6,19.90])
      .zoom(6)
      .cluster(false)
      .renderPopup(true)
      .filterByArea(true)
	  //.title(function (d) {return d.key + ": "+d.value+" individuals";})
    ;

  var pref = xf.dimension(function(d) { return d.Prefecture; });
  var villsect = pref.group().reduceCount();
  
  dc.rowChart("#cccm .pref",groupname)
        .dimension(pref)
        .group(villsect)
		//.filter(function(d) { if (d !="NA") {return d;} })
		//.data(function(group) {
		//	return group.all().filter(function(kv) { return kv.key !="NA"; });
		//	})
        .elasticX(true)
        .width(300)
        .height(300)
        .renderLabel(true)
        .colors(['#58585A'])
		.ordering(function (p) { return -p.value;})
        .colorDomain([0,0])
        .colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format("s"));

  var prefec = xf.dimension(function(d) { return d.Prefecture; });
  var pop_pref = pref.group().reduceSum(function (d) { return d.Individus_deplaces; });
  
  dc.rowChart("#cccm .prefpop",groupname)
        .dimension(prefec)
        .group(pop_pref)
		//.filter("NA")
		//.filter(function(d) { if (d !="NA") {return d;} })
        .elasticX(true)
        .width(300)
        .height(300)
        .renderLabel(true)
        .colors(['#58585A'])
		.ordering(function (p) { return -p.value;})
        .colorDomain([0,0])
        .colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format("s"));

		//************ Recommandation_Intervention_NFI,Recommandation_Intervention_EAH,Recommandation_Pas_intervention,Recommandation_Intervention_Sante,Recommandation_Intervention_Protection,Recommandation_Securite_Alimentaire,Recommandation_Intervention_Education,Recommandation_Intervention_Logistique
		
		  var pro_accDIM = xf.dimension(function(d) { return d["Recommandation_Intervention_NFI"]; });
		  var pro_accGroup = pro_accDIM.group();  
		  
		  var protDim = xf.dimension(function(d) { return d["Recommandation_Intervention_EAH"]; });
		  var protGP = protDim.group();  
		  
		  var proMSADim = xf.dimension(function(d) { return d["Recommandation_Pas_intervention"]; });
		  var proMSAGP = proMSADim.group();
		  
		  var dispDim = xf.dimension(function(d) { return d["Recommandation_Intervention_Sante"]; });
		  var dispGP = dispDim.group();
			
		  var pr_dirDim = xf.dimension(function(d) { return d["Recommandation_Intervention_Protection"]; });
		  var pr_dirGP = pr_dirDim.group();

		  var pr_sectDim = xf.dimension(function(d) { return d["Recommandation_Securite_Alimentaire"]; });
		  var pr_sectGP = pr_sectDim.group();

		  var pr_logDim = xf.dimension(function(d) { return d["Recommandation_Intervention_Education"]; });
		  var pr_logGP = pr_logDim.group();
		  
		  var pr_PasActionDim = xf.dimension(function(d) { return d["Recommandation_Intervention_Logistique"]; });
		  var pr_PasActionGP = pr_PasActionDim.group();

		 // var pr_AutreDim = xf.dimension(function(d) { return d["Proposition_Action_Autre"]; });
		  //var pr_AutreGP = pr_AutreDim.group();

		  dc.pieChart("#cccm .pro_accDIV",groupname).dimension(pro_accDIM).group(pro_accGroup).width(60).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
		  dc.pieChart("#cccm .protDIV",groupname).dimension(protDim).group(protGP).width(60).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
		  dc.pieChart("#cccm .proMSADIV",groupname).dimension(proMSADim).group(proMSAGP).width(60).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
		  dc.pieChart("#cccm .dispDIV",groupname).dimension(dispDim).group(dispGP).width(60).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
		  dc.pieChart("#cccm .pr_dirDIV",groupname).dimension(pr_dirDim).group(pr_dirGP).width(60).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
		  dc.pieChart("#cccm .pr_sectDIV",groupname).dimension(pr_sectDim).group(pr_sectGP).width(60).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
		  dc.pieChart("#cccm .pr_logDIV",groupname).dimension(pr_logDim).group(pr_logGP).width(60).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
		  dc.pieChart("#cccm .pr_PasActionDIV",groupname).dimension(pr_PasActionDim).group(pr_PasActionGP).width(65).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
		  //dc.pieChart("#cccm .pr_AutreDIV",groupname).dimension(pr_AutreDim).group(pr_AutreGP).width(60).height(80).innerRadius(10).colors(d3.scale.ordinal().range(  [ '#999999', '#3182bd']));
	
			//************


	
		
  var ONGDim  = xf.dimension(function(d) { return d.Score_NFI; });
  var ONGsect = ONGDim.group();
  
  var NONGsect = ONGDim.group().reduce(reduceAdd, reduceRemove, reduceInitial);

		function reduceAdd(p, v) {
		  ++p.count;
		  p.total += v.value;
		  return p;
		}

		function reduceRemove(p, v) {
		  --p.count;
		  p.total -= v.value;
		  return p;
		}

		function reduceInitial() {
		  return {count: 0, total: 0};
		}

	
var ScoreNFI = xf.dimension(function(d) {
			if (d.Score_NFI < 3.5 )
			  return "A: < 3.5"
			else if (d.Score_NFI >= 3.5  & d.Score_NFI < 4.0 )
			  return "B: 3.5 - 3.9"  
			else if (d.Score_NFI >= 4.0  & d.Score_NFI < 4.5 )
			  return "C: 4.0 - 4.4"    
			else if (d.Score_NFI >= 4.5 )
			  return "D: 4.5 - 5.0"
			else
			  return "NA"   			
			});  
var ScoreNFIDim = ScoreNFI.group().reduceCount();

  dc.rowChart("#cccm .SCORE_NFI",groupname)
        .dimension(ScoreNFI)
        .group(ScoreNFIDim)
		//.data(function(group) {return group.all().filter(function(kv) { return kv.key !=""; });})
        .width(300)
        .height(200)
        .renderLabel(true)
        //.ordering(function (p) { return p.value;})
		.colors(['#ff9999','#ff3333','#cc0000','#800000', ])
        //.colors(d3.scale.ordinal()
		//	.domain([5,1])
		//	.range(colorbrewer.OrRd[5])
		//)
        //.colorDomain([0,0])
		.elasticX(true)
        //.x(d3.scale.ordinal().domain(["3.5 - 3.9","4.0 - 4.4","4.5 - 5.0","NA","< 3.5",]))
        .xAxis().ticks(4).tickFormat(d3.format());
	
	//*************	
	
	//********	
	var pref1 = xf.dimension(function(d) { return d.Code_Prefecture; });
	var nombre = pref1.group().reduceSum(function (d) { if (d.Status_Complete == "Oui" )
			  return 1; else return 1; });
	 		  
	dc.rowChart("#cccm .nombre",groupname)
        .dimension(pref1)
        .group(nombre)
        .width(800)
		.height(40)
        .colors(['#FF6600'])
		.label(function(d) { return "Nombre total de MSA: "+d.value; })
		.margins({top: 10, right: 5, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.25]));	 
			  
	//********	

	
	/*var StatusDim  = xf.dimension(function(d) { 
		if (d.Status_Complete == "Oui" )
			  return "Complété"
			else if (d.Status_Prevu == "Oui")
			  return "Prévu" 
			 else if (d.Status_En_cours == "Oui" )
			  return "En cours"   
			else if (d.Status_En_attente == "Oui" )
			  return "En attente"
			else if (d.Status_Annule == "Oui" )
			  return "Annnulé"
			else 
			  return "Sans status"  
			 
			});  
  var Statussect = StatusDim.group().reduceCount();
  
	dc.barChart("#cccm .Status",groupname)
		.dimension(StatusDim)
        .group(Statussect)
		.width(450)
        .height(220)
		.x(d3.scale.ordinal().domain(["Complété","Prévu","En cours","En attente","Annnulé","Sans status"]))
		.colors(['#398E1D','#ff3333','#cc0000','#800000', ])
		.colorAccessor(function(d, i){return 2;})
		.xUnits(dc.units.ordinal)
		.transitionDuration(500)
		.centerBar(true)	
		.gap(10
)  // 65 = norm
		.elasticY(true)
		//.xAxisLabel('Status')
		.yAxisLabel('Nombre d’activités')
		.xAxis().tickFormat(function (d) {
        return d})
		;	*/
	//*************	Recommandation
		
	
	var pref1 = xf.dimension(function(d) { return d.Code_Prefecture; });
	var Intervention_NFI = pref1.group().reduceSum(function (d) { if (d.Recommandation_Intervention_NFI == "Oui" )
			  return 1; else return 0; });
	var  Intervention_EAH = pref1.group().reduceSum(function (d) { if (d.Recommandation_Intervention_EAH == "Oui" )
			  return 1; else return 0; });
	var  Pas_intervention= pref1.group().reduceSum(function (d) { if (d.Recommandation_Pas_intervention == "Oui" )
			  return 1; else return 0; });
	var  Intervention_Sante= pref1.group().reduceSum(function (d) { if (d.Recommandation_Intervention_Sante == "Oui" )
			  return 1; else return 0; });
	var  Intervention_Protection= pref1.group().reduceSum(function (d) { if (d.Recommandation_Intervention_Protection == "Oui" )
			  return 1; else return 0; });
	var  Securite_Alimentaire= pref1.group().reduceSum(function (d) { if (d.Recommandation_Securite_Alimentaire == "Oui" )
			  return 1; else return 0; });
	var  Intervention_Education= pref1.group().reduceSum(function (d) { if (d.Recommandation_Intervention_Education == "Oui" )
			  return 1; else return 0; });
	var  Intervention_Logistique= pref1.group().reduceSum(function (d) { if (d.Recommandation_Intervention_Logistique == "Oui" )
			  return 1; else return 0; });
	 
  	  dc.rowChart("#cccm .PropAction",groupname)
        .dimension(pref1)
        .group(Intervention_NFI)
        .width(300)
        .height(50)
        .colors(['#CC3333'])
		.label(function(d) { return "Intervention Abris/NFI: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.3]));
	  dc.rowChart("#cccm .PropAction1",groupname)
        .dimension(pref1)
        .group(Intervention_EAH)
        .width(300)
        .height(50)
        .colors(['#CC3333'])
		.label(function(d) { return "Intervention EAH: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.3]));
	  dc.rowChart("#cccm .PropAction2",groupname)
        .dimension(pref1)
        .group(Pas_intervention)
        .width(300)
        .height(50)
        .colors(['#CC3333'])
		.label(function(d) { return "Pas d'intervention: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.3]));
	  dc.rowChart("#cccm .PropAction3",groupname)
        .dimension(pref1)
        .group(Intervention_Sante)
        .width(300)
        .height(50)
        .colors(['#CC3333'])
		.label(function(d) { return "Intervention Santé/Nutrition: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.3]));
	  dc.rowChart("#cccm .PropAction4",groupname)
        .dimension(pref1)
        .group(Intervention_Protection)
        .width(300)
        .height(50)
        .colors(['#CC3333'])
		.label(function(d) { return "Intervention Protection: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.3]));
	  dc.rowChart("#cccm .PropAction5",groupname)
        .dimension(pref1)
        .group(Securite_Alimentaire)
        .width(300)
        .height(50)
        .colors(['#CC3333'])
		.label(function(d) { return "Securité Alimentaire: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.3]));
	   dc.rowChart("#cccm .PropAction6",groupname)
        .dimension(pref1)
        .group(Intervention_Education)
        .width(300)
        .height(50)
        .colors(['#CC3333'])
		.label(function(d) { return "Intervention Education: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.3]));
	  dc.rowChart("#cccm .PropAction7",groupname)
        .dimension(pref1)
        .group(Intervention_Logistique)
        .width(300)
        .height(50)
        .colors(['#CC3333'])
		.label(function(d) { return "Intervention Logistique: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.3]));
	  	
	
	/*
	var PropActionDim  = xf.dimension(function(d) {
			if (d.Recommandation_Intervention_NFI == "Oui" )
			  return "Intervention Abris/NFI"
			else if (d.Recommandation_Intervention_EAH == "Oui")
			  return "Intervention EAH" 
			 else if (d.Recommandation_Pas_intervention == "Oui" )
			  return "Pas d'intervention"   
			else if (d.Recommandation_Intervention_Sante == "Oui" )
			  return "Intervention Santé/Nutrition"
			else if (d.Recommandation_Intervention_Protection == "Oui")
			  return "Intervention Protection" 
			 else if (d.Recommandation_Securite_Alimentaire == "Oui" )
			  return "Securité Alimentaire"   
			else if (d.Recommandation_Intervention_Education == "Oui" )
			  return "Intervention Education"
			else if (d.Recommandation_Intervention_Logistique == "Oui" )
			  return "Intervention Logistique"  
			else 
			  return "Autre"  
			 
			}); 
			
  var PropActionsect = PropActionDim.group().reduceCount();

  dc.rowChart("#cccm .PropAction",groupname)
        .dimension(PropActionDim)
        .group(PropActionsect)
        .elasticX(true)
        .width(300)
        .height(300)
        .renderLabel(true)
        .ordering(function (p) { return -p.value;})
        .colors(['#398E1D'])
        .colorDomain([0,0])
        .colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(5).tickFormat(d3.format(""));		*/
	//***************	
/*
	 var CauseIntDim  = xf.dimension(function(d) { 
			if (d.Delais_INT_Disponibilite == "Oui" )
			  return "Disponibilité-mobilisation de resources"
			else if (d.Delai_INT_Coordination_humanitaire == "Oui")
			  return "Coordination humanitaire" 
			 else if (d.Delais_INT_Defaillance_BD == "Oui" )
			  return "Défaillance des base de données"   
			else if (d.Delais_INT_Intervention_multiple == "Oui" )
			  return "Intervention multiple (indisponibilité des équipes)"
			else if (d.Delais_INT_Autre == "Oui")
			  return "Autre" 
			else if (d.Delais_INT_NA == "Oui")
			  return "NA"   
			else 
			  return "NAX"    
			
			 }); 
			
  var CauseIntsect = CauseIntDim.group().reduceCount();

  dc.rowChart("#cccm .CauseInt",groupname)
        .dimension(CauseIntDim)
        .group(CauseIntsect)
        .elasticX(true)
        .width(300)
        .height(200)
        .renderLabel(true)
        .ordering(function (p) { return -p.value;})
        .colors(['#CC3333'])
        .colorDomain([0,0])
        .colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(5).tickFormat(d3.format("s"));	*/
		
	/*var pref2 = xf.dimension(function(d) { return d.Code_Prefecture; });
		
		var INT_Disponibilite = pref2.group().reduceSum(function (d) { if (d.Delais_INT_Disponibilite == "Oui" )
			  return 1; else return 0; });
	    var INT_Coordination_humanitaire = pref2.group().reduceSum(function (d) { if (d.Delais_INT_Coordination_humanitaire == "Oui" )
			  return 1; else return 0; });
	    var INT_Defaillance_BD = pref2.group().reduceSum(function (d) { if (d.Delai_INT_Defaillance_BD == "Oui" )
			  return 1; else return 0; });
	    var INT_Intervention_multiple = pref2.group().reduceSum(function (d) { if (d.Delais_INT_Intervention_multiple == "Oui" )
			  return 1; else return 0; }); 	 
		var INT_NA = pref2.group().reduceSum(function (d) { if (d.Delais_INT_NA == "Oui" )
			  return 1; else return 0; }); 
	    var INT_Autre = pref2.group().reduceSum(function (d) { if (d.Delais_INT_Autre == "Oui" )
			  return 1; else return 0; });
	 

  	    dc.rowChart("#cccm .CauseInt1",groupname)
        .dimension(pref2)
        .group(INT_Disponibilite)
        .width(400)
        .height(40)
        .colors(['#FF6600'])
		.label(function(d) { return "Disponibilité de ressources: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseInt2",groupname)
        .dimension(pref2)
        .group(INT_Coordination_humanitaire)
        .width(400)
        .height(50)
        .colors(['#FF6600'])
		.label(function(d) { return "Coordination humanitaire: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseInt3",groupname)
        .dimension(pref2)
        .group(INT_Defaillance_BD)
        .width(400)
        .height(50)
        .colors(['#FF6600'])
		.label(function(d) { return "DéfaillanceBD: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseInt4",groupname)
        .dimension(pref2)
        .group(INT_Intervention_multiple)
        .width(400)
        .height(50)
        .colors(['#FF6600'])
		.label(function(d) { return "Intervention multiple: "+d.value; })
		.margins({top: 10, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseInt5",groupname)
        .dimension(pref2)
        .group(INT_Autre)
        .width(400)
        .height(50)
        .colors(['#FF6600'])
		.label(function(d) { return "Autre: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	 dc.rowChart("#cccm .CauseInt6",groupname)
        .dimension(pref2)
        .group(INT_NA)
        .width(400)
        .height(50)
        .colors(['#FF6600'])
		.label(function(d) { return "Pas de délais: "+d.value; })
		.margins({top: 10, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));*/
	 
	
		
		
	//************	
		/*var pref2 = xf.dimension(function(d) { return d.Code_Prefecture; });
		
		var EXT_Necessite_reevaluer = pref2.group().reduceSum(function (d) { if (d.Delais_EXT_Necessite_reevaluer == "Oui" )
			  return 1; else return 0; });
	    var EXT_Acces_logistique = pref2.group().reduceSum(function (d) { if (d.Delais_EXT_Acces_logistique == "Oui" )
			  return 1; else return 0; });
	    var EXT_Suspension_logistique = pref2.group().reduceSum(function (d) { if (d.Delai_EXT_Suspension_logistique == "Oui" )
			  return 1; else return 0; });
	    var EXT_Acceptance_parties_prenantes = pref2.group().reduceSum(function (d) { if (d.Delais_EXT_Acceptance_parties_prenantes == "Oui" )
			  return 1; else return 0; }); 	 
		var EXT_EquipeRRM_cible_pendant_MSA = pref2.group().reduceSum(function (d) { if (d.Delais_EXT_EquipeRRM_cible_pendant_MSA == "Oui" )
			  return 1; else return 0; }); 
	    var EXT_Acces_securitaire = pref2.group().reduceSum(function (d) { if (d.Delais_EXT_Acces_securitaire == "Oui" )
			  return 1; else return 0; });
	    var EXT_Suspension_securitaire = pref2.group().reduceSum(function (d) { if (d.Delais_EXT_Suspension_securitaire == "Oui" )
			  return 1; else return 0; });
	    var EXT_Autre = pref2.group().reduceSum(function (d) { if (d.Delais_EXT_Autre == "Oui" )
			  return 1; else return 0; }); 	 
		var EXT_NA = pref2.group().reduceSum(function (d) { if (d.Delais_EXT_NA == "Oui" )
			  return 1; else return 0; }); 

  	    dc.rowChart("#cccm .CauseExt1",groupname)
        .dimension(pref2)
        .group(EXT_Necessite_reevaluer)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "Necessité re-évaluer: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseExt2",groupname)
        .dimension(pref2)
        .group(EXT_Acces_logistique)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "Accès logistique: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseExt3",groupname)
        .dimension(pref2)
        .group(EXT_Suspension_logistique)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "Suspension logistique: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseExt4",groupname)
        .dimension(pref2)
        .group(EXT_Acceptance_parties_prenantes)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "Acceptance parties prenantes: "+d.value; })
		.margins({top: 5, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	 dc.rowChart("#cccm .CauseExt5",groupname)
        .dimension(pref2)
        .group(EXT_EquipeRRM_cible_pendant_MSA)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "EquipeRRM ciblé pendant MSA: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseExt6",groupname)
        .dimension(pref2)
        .group(EXT_Acces_securitaire)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "Acces sécuritaire: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseExt7",groupname)
        .dimension(pref2)
        .group(EXT_Suspension_securitaire)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "Suspension sécuritaire: "+d.value; })
		.margins({top: 5, right: 10, bottom: -1, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	  dc.rowChart("#cccm .CauseExt8",groupname)
        .dimension(pref2)
        .group(EXT_Autre)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "Autre: "+d.value; })
		.margins({top: 5, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));
	dc.rowChart("#cccm .CauseExt9",groupname)
        .dimension(pref2)
        .group(EXT_NA)
        .width(400)
        .height(33)
        .colors(['#CC3333'])
		.label(function(d) { return "Pas de délais: "+d.value; })
		.margins({top: 5, right: 10, bottom: 0, left: 30})
		.x(d3.scale.linear().domain([0, 0.1]));*/
		
		
		//************
	
	var PartnerDim = xf.dimension(function(d) { return d['Partner']; });
var Partnergp = PartnerDim.group().reduceCount();

  dc.rowChart("#cccm .Partner",groupname)
        .dimension(PartnerDim)
        .group(Partnergp)
        .elasticX(true)
        .width(250)
        .height(300)
        .renderLabel(true)
        .ordering(function (p) { return -p.value;})
        .colors(['#FF6600'])
        .colorDomain([0,0])
        .colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format("s"));
		
		//************	

		
		
var Direct_Contractor_VoucherDim = xf.dimension(function(d) { 
			if (d.X_score_de_Consommation_alimentaire_Pauvre > 0  & d.X_score_de_Consommation_alimentaire_Pauvre <= 20 )
			  return "0 - 20 %"
			else if (d.X_score_de_Consommation_alimentaire_Pauvre > 20  & d.X_score_de_Consommation_alimentaire_Pauvre <= 40 )
			  return "20 - 40 %"  
			else if (d.X_score_de_Consommation_alimentaire_Pauvre > 40  & d.X_score_de_Consommation_alimentaire_Pauvre <= 60 )
			  return "40 - 60 %"    
			else if (d.X_score_de_Consommation_alimentaire_Pauvre > 60  & d.X_score_de_Consommation_alimentaire_Pauvre <= 80 )
			  return "60 - 80 %"     
			 else if (d.X_score_de_Consommation_alimentaire_Pauvre > 80 )
			  return "> 80 %"
			else
			  return "NA"   			
			});  
var Direct_Contractor_Vouchergp = Direct_Contractor_VoucherDim.group().reduceCount();

  dc.rowChart("#cccm .FCS_poor",groupname)
        .dimension(Direct_Contractor_VoucherDim)
        .group(Direct_Contractor_Vouchergp)
		.width(200)
        .height(200)
        .renderLabel(true)
		.valueAccessor(function(d) { return d.value  })
		.title(function(d) { return d.key + " (" + Math.floor(d.value ,0) + "%)"; })
		.elasticX(true)
		.xAxis()
		.ticks(2).tickFormat(d3.format(""));	
		
var IntervDim = xf.dimension(function(d) { 
			if (d.X_score_de_Consommation_alimentaire_Limite > 0 &  d.X_score_de_Consommation_alimentaire_Limite <= 40)
			  return "0 - 20 %"
			else if (d.X_score_de_Consommation_alimentaire_Limite > 20  & d.X_score_de_Consommation_alimentaire_Limite <= 40 )
			  return "20 - 40 %"  
			else if (d.X_score_de_Consommation_alimentaire_Limite > 40  & d.X_score_de_Consommation_alimentaire_Limite <= 60 )
			  return "40 - 60 %"    
			else if (d.X_score_de_Consommation_alimentaire_Limite > 60  & d.X_score_de_Consommation_alimentaire_Limite <= 80 )
			  return "60 - 80 %"     
			 else if (d.X_score_de_Consommation_alimentaire_Limite > 80 )
			  return "> 80 %"
			else
			  return "NA"   			
			}); 
var Intervgp = IntervDim.group();

  dc.rowChart("#cccm .FCS_borderline",groupname)
        .dimension(IntervDim)
        .group(Intervgp)
        .elasticX(true)
        .width(200)
        .height(200)
		.renderLabel(true)
      //.ordering(function (p) { return -p.value;})
        //.colors(d3.scale.ordinal()
			//.domain(["0-20%", "20-40%", "40-60%","60-80%","80-100%"])
		//	.range(colorbrewer.OrRd[5])
		//	)
      //.colors(d3.scale.category(["#3182bd","#6baed6","#6baed6","#9ecae1","#9ecae1","#c6dbef","#c6dbef"]))
		.elasticX(true)
        //.colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format("s"));

var FCS_acc = xf.dimension(function(d) { 
			if (d.X_score_de_Consommation_alimentaire_Acceptable > 0 & d.X_score_de_Consommation_alimentaire_Acceptable <= 20)
			  return "0 - 20 %"
			else if (d.X_score_de_Consommation_alimentaire_Acceptable > 20  & d.X_score_de_Consommation_alimentaire_Acceptable <= 40 )
			  return "20 - 40 %"  
			else if (d.X_score_de_Consommation_alimentaire_Acceptable > 40  & d.X_score_de_Consommation_alimentaire_Acceptable <= 60 )
			  return "40 - 60 %"    
			else if (d.X_score_de_Consommation_alimentaire_Acceptable > 60  & d.X_score_de_Consommation_alimentaire_Acceptable <= 80 )
			  return "60 - 80 %"     
			 else if (d.X_score_de_Consommation_alimentaire_Acceptable > 80 )
			  return "> 80 %"
			else 
			  return "NA"   			
			}); 
var FCS_accGroup = FCS_acc.group();

  dc.rowChart("#cccm .FCS_acceptable",groupname)
        .dimension(FCS_acc)
        .group(FCS_accGroup)
        .elasticX(true)
        .width(200)
        .height(200)
        .renderLabel(true)
        //.ordering(function (p) { return -p.value;})
        .colors(d3.scale.ordinal()
			.domain(["0-20%", "20-40%", "40-60%","60-80%","80-100%"])
			.range(colorbrewer.OrRd[5])
			)
		.elasticX(true)
        //.colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format("s"));
		
var waterDim = xf.dimension(function(d) {
			if (d.X_des_menages_avec_un_source_eau_potable_amelioree > 0 & d.X_des_menages_avec_un_source_eau_potable_amelioree <= 20)
			  return "0 - 20 %"
			else if (d.X_des_menages_avec_un_source_eau_potable_amelioree > 20  & d.X_des_menages_avec_un_source_eau_potable_amelioree <= 40 )
			  return "20 - 40 %"  
			else if (d.X_des_menages_avec_un_source_eau_potable_amelioree > 40  & d.X_des_menages_avec_un_source_eau_potable_amelioree <= 60 )
			  return "40 - 60 %"    
			else if (d.X_des_menages_avec_un_source_eau_potable_amelioree > 60  & d.X_des_menages_avec_un_source_eau_potable_amelioree <= 80 )
			  return "60 - 80 %"     
			 else if (d.X_des_menages_avec_un_source_eau_potable_amelioree > 80 )
			  return "> 80 %"
			else 
			  return "NA"   			
			}); 
var waterDimGroup = waterDim.group().reduceCount();

  dc.rowChart("#cccm .water",groupname)
        .dimension(waterDim)
        .group(waterDimGroup)
        .elasticX(true)
        .width(200)
        .height(200)
        .renderLabel(true)
        //.ordering(function (p) { return -p.value;})
       .colors(d3.scale.ordinal()
			//.domain(["0-20%", "20-40%", "40-60%","60-80%","80-100%"])
			.range(colorbrewer.PuBu[5])
			)
        //.colorDomain([0,0])
       //.colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format("s"));
		
var latrineDim = xf.dimension(function(d) { 
			if (d.X_des_menages_ayant_acces_a_une_latrine_hygienique > 0 & d.X_des_menages_ayant_acces_a_une_latrine_hygienique <= 20 )
			  return "0 - 20 %"
			else if (d.X_des_menages_ayant_acces_a_une_latrine_hygienique > 20  & d.X_des_menages_ayant_acces_a_une_latrine_hygienique <= 40 )
			  return "20 - 40 %"  
			else if (d.X_des_menages_ayant_acces_a_une_latrine_hygienique > 40  & d.X_des_menages_ayant_acces_a_une_latrine_hygienique <= 60 )
			  return "40 - 60 %"    
			else if (d.X_des_menages_ayant_acces_a_une_latrine_hygienique > 60  & d.X_des_menages_ayant_acces_a_une_latrine_hygienique <= 80 )
			  return "60 - 80 %"     
			 else if (d.X_des_menages_ayant_acces_a_une_latrine_hygienique > 80 )
			  return "> 80 %"
			else 
			  return "NA"   			
			}); 
var latrineGP = latrineDim.group();

  dc.rowChart("#cccm .latrine",groupname)
        .dimension(latrineDim)
        .group(latrineGP)
        .elasticX(true)
        .width(200)
        .height(200)
        .renderLabel(true)
      //.ordering(function (p) { return -p.value;})
        .colors(d3.scale.ordinal()
			.domain(["0-20%", "20-40%", "40-60%","60-80%","80-100%"])
			.range(colorbrewer.Greys[5])
			)
      //.colors(d3.scale.category(["#3182bd","#6baed6","#6baed6","#9ecae1","#9ecae1","#c6dbef","#c6dbef"]))
		.elasticX(true)
        //.colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format("s"));

var shelterDim = xf.dimension(function(d) { 
			if (d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard > 0 & d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard <= 20)
			  return "0 - 20 %"
			else if (d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard > 20  & d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard <= 40 )
			  return "20 - 40 %"  
			else if (d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard > 40  & d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard <= 60 )
			  return "40 - 60 %"    
			else if (d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard > 60  & d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard <= 80 )
			  return "60 - 80 %"     
			 else if (d.X_de_menages_vivant_ds_un_abris_en_dessous_des_standard > 80 )
			  return "> 80 %"
			else 
			  return "NA"   			
			}); 
var shelterGP = shelterDim.group();

  dc.rowChart("#cccm .abris",groupname)
        .dimension(shelterDim)
        .group(shelterGP)
        .elasticX(true)
        .width(200)
        .height(200)
        .renderLabel(true)
        //.ordering(function (p) { return -p.value;})
        .colors(d3.scale.ordinal()
			.domain(["0-20%", "20-40%", "40-60%","60-80%","80-100%"])
			.range(colorbrewer.Greens[5])
			)
		.elasticX(true)
        //.colorAccessor(function(d, i){return 1;})
        .xAxis().ticks(4).tickFormat(d3.format("s"));
		
 
 /*var yeargp  = xf.dimension(function(d) { return d.year});
			
			
  var yeargroup = yeargp.group().reduceCount();

    dc.barChart("#cccm .year",groupname)
		.dimension(yeargp)
		.group(yeargroup)
		.width(200)
        .height(200)
		.xUnits(d3.time.month)
		.margins({top: 10, right: 25, bottom: 25, left: 25})
		.xAxis()
		.ticks(4)
		//.tickFormat(d3.format("%Y"));*/
		
var yeargp  = xf.dimension(function(d) { return d.year; });
			
  var yeargroup = yeargp.group().reduceCount();

    dc.barChart("#cccm .year",groupname)
		.dimension(yeargp)
		.group(yeargroup)
		.width(300)
        .height(220)
		.x(d3.scale.ordinal().domain([2014,2015]))
		
		.xUnits(dc.units.ordinal)
		.transitionDuration(500)
		.centerBar(true)	
		.gap(50)  // 65 = norm
		.elasticY(true)
		.xAxisLabel('Année')
		.yAxisLabel('Nombre d’activités')
		.xAxis().tickFormat(function (d) {
        return d})
		;		

var stdateDim = xf.dimension(function(d) {return d.month});
var stdategp = stdateDim.group();
var times = function(d) {return d.DD};

 dc.lineChart("#cccm .start_dates",groupname)
		.height(200)
		.width(500)
        .dimension(stdateDim)
		.group(stdategp)
		.x(d3.time.scale())
	    .round(d3.time.month.round)
	    .xUnits(d3.time.month)
	    .elasticY(true)
		.elasticX(true)
		.margins({top: 10, right: 10, bottom: 30, left: 30})
		.renderHorizontalGridLines(true)
		.renderArea(true)
		.dotRadius(8)
		
		.yAxisLabel('Nombre d’activités')
		.xAxis().ticks(8)
		;

$('#reset').on('click', function (){
  dc.filterAll(groupname);
  dc.redrawAll(groupname);
  return false;
})


  dc.renderAll(groupname);
}

  
</script>

 <script src="js/bootstrap.js"></script>
<!-- Custom Theme JavaScript -->
<script>
// Closes the sidebar menu
$("#menu-close").click(function(e) {
    e.preventDefault();
    $("#sidebar-wrapper").toggleClass("active");
});

// Opens the sidebar menu
$("#menu-toggle").click(function(e) {
    e.preventDefault();
    $("#sidebar-wrapper").toggleClass("active");
});

// Scrolls to the selected menu item on the page
$(function() {
    $('a[href*=#]:not([href=#])').click(function() {
        if (location.pathname.replace(/^\//, '') == this.pathname.replace(/^\//, '') || location.hostname == this.hostname) {

            var target = $(this.hash);
            target = target.length ? target : $('[name=' + this.hash.slice(1) + ']');
            if (target.length) {
                $('html,body').animate({
                    scrollTop: target.offset().top
                }, 1000);
                return false;
            }
        }
    });
});
</script>

</body>


</html>
