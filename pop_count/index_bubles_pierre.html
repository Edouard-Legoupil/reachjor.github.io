<html lang='en'>
<head>
<meta charset='utf-8'>
<meta content='width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0' name='viewport'>
<meta name="author" content="Aung Thu Win based on original work by Edouard Legoupil">
<meta property="og:title" content="2014 Refugee Response in Lebanon"/>
<meta property="og:type" content="article"/>
<meta property="og:url" content="http://data.unhcr.org/Lebanon/response/shelter"/>
<meta property="og:image" content="http://data.unhcr.org/Lebanon/images/shelterdashboard.jpg"/>
<meta property="og:site_name" content="2014 Syrian Refugee Response in Lebanon"/>
<meta property="og:description" content="2014 Syrian Refugee Response in Lebanon"/>
    <title>2014 Syrian Refugee Response in Lebanon</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="../../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../css/dc.css"/>
    <link rel="stylesheet" type="text/css" href="../../css/3w-dashboard.css"/>
    <!-- Add IntroJs styles and JS -->
    <link rel="stylesheet" type="text/css" href="../../css/introjs.min.css" >
    <script type="text/javascript" src="../../js/intro.min.js"></script>
    <script src="../../js/jquery.js"></script>
	
    <!-- map the data to the GeoJSON object -->
    <script src="../../js/lbn-pcode.js"></script>
    <link href="http://www.unhcr.org/favicon.ico" rel="icon" type="image/x-icon">
</head>
	<body>
		<div class="container-fluid" id="dashboard">
			<div class="row" style="background-color:#ffc000;color:#ffffff;display">
			<div class="col-md-2">
				<center>
				<br>
				<img src="../../icons/Lebanon_InterAgency.png" style="max-height:48; max-weight:64" />
				<img src="../../icons/Shelter.png" style="max-height:48; max-weight:64" /> <br>
				Shelter Working Group (Lebanon)
				</center>
			</div>
			<div class="col-md-6">
				<center>
					<h3><strong>2014 Syrian Refugee Response in Lebanon</strong></h3>
					Explore <a href="http://www.unhcr.org/52b170e49.html" target="_blank" >2014 Interagency Response Plan</a> 
					for Refugee Crisis in Lebanon. 
					More info on Lebanon <a href="http://data.unhcr.org/syrianrefugees/country.php?id=122" target="_blank" >here</a>. <br>
					<strong>The following charts shows the achievement of Shelter sector. Click on any of the graphs below to filter and slice the data.</strong>
				</center>
			</div>
			<div class="col-md-4">
				<div class="col-md-5">
					<br>
					<div id="count-info" data-step="12" data-intro="Click on this button to clear all the filters." data-position='right'><strong><span class="filter-count "></span></strong> selected out of <span class="total-count "></span> records</div>
					<a class="reset btn btn-primary btn-sm" id="reset" href="javascript:dc.filterAll();dc.redrawAll();">Reset All</a>
				</div>
				<br>
				<div class="col-md-4">
					<br>
					<a class="btn btn btn-success" href="javascript:void(0);" onclick="javascript:introJs().start();">Tutorial</a>
				</div>			
				<div class="col-md-3">
				<div class="socialmedia" data-step="11" data-intro="Feel Free to share if you like it!" data-position='left'>
					<table>
					  <tr>
						<td valign="middle" ><a href="http://www.facebook.com/sharer.php?u=http://data.unhcr.org/Lebanon/response/shelter" target="_blank"><img src="../../images/Facebook.png" style="height: 25px; width: 25px"/></a></td>
						<td valign="middle"><a href="http://pinterest.com/pin/create/button/?url=http%3A%2F%2Fdata.unhcr.org/Lebanon/response/shelter&amp;media=http%3A%2F%2Fdata.unhcr.org/Lebanon/images/shelterdashboard.jpg" target="_blank" data-pin-do="buttonBookmark" ><img src="../../images/Pinterest.png" style="height: 28px; width: 28px"/></a></td>
						<td valign="middle"><a href="https://twitter.com/intent/tweet?url=http://data.unhcr.org/Lebanon/response/shelter&text=%23Lebanon%20@Refugees" target="_blank"><img src="../../images/Twitter.png" style="height: 25px; width: 25px"/></a></td>
						<td valign="middle"><a href="https://plus.google.com/share?&hl=en&url=http://data.unhcr.org/Lebanon/response/shelter" target="_blank"><img src="../../images/Google.png" style="height: 25px; width: 25px"/></a></td>
					</tr>
					</table>
					<div class="col-md-4 col-md-offset-4">
						<small><a href="https://github.com/UNHCR-Lebanon" target="_blank" >Source</a></small> <br>
					</div>
				</div>
				</div>
			</div>
			</div>
			<div class="row">
				<div class="col-md-3">
					<div class="row">
						<center>
						<div id="indicator" data-step="1" data-intro="Click on this row chart to filter by Indicator." data-position='right'>
							<center><h5><strong>Indicator</strong>(# of Persons)</h5></center>
						</div>
						</center>
					</div>
					<div class="row">
						<center>
						<div id="ppg" data-step="2" data-intro="Click on this pie chart to filter by Population Cohort." data-position='right'>
							<center><h5><strong>Population Cohort</strong>(# of Persons)</h5></center>
						</div>
						</center>
					</div>
					<div class="row">
						<center>
						<div id="funded" data-step="3" data-intro="Click on this pie chart to filter by Funding Agency." data-position='right'>
							<center><h5><strong>Funding Agency</strong>(# of Persons)</h5></center>
						</div>
						</center>
					</div>
					<div class="row">
						<center>
						<div id="rrp6" data-step="4" data-intro="Click on this row chart to filter by RRP6 status of the report." data-position='right'>
							<center><h5><strong>RRP6(Yes/No)</strong>(# of Persons)</h5></center>
						</div>
						</center>
					</div>
				</div>
				<div class="col-md-3">
					<div class="row">
						<center>
						<div id="partner" data-step="5" data-intro="Click on this row chart to filter by Partner." data-position='right'>
							<center><h5><strong>Partner</strong>(# of Persons)</h5></center>
						</div>
						</center>
					</div>
					<div class="row">
						<center>
						<div id="sitetype" data-step="6" data-intro="Click on this row chart to filter by Site Type." data-position='right'>
							<center><h5><strong>Site Type</strong>(# of Persons)</h5></center>
						</div>
						</center>
					</div>
				</div>
				<div class="col-md-6">
				<div class="row">
					<div class="col-md-6">					
						<div id="area" class="col-xs-12 col-md-8" data-step="7" data-intro="Click on this map to filter by Area of operation." data-position='right'>
							<center><h5><strong>Area</strong>(# of Persons)</h5></center>
						</div>
					</div>
					<div class="col-md-6">
						<div id="caza" class="col-xs-12 col-md-8" data-step="8" data-intro="Click on this map to filter by Caza(District)." data-position='right'>
							<center><h5><strong>Caza(District)</strong>(# of Persons)</h5></center>
						</div>
					</div>
				</div>
				<div class="row">
					<div id="month" class="col-md-12" data-step="9" data-intro="Click on this line chart to zoom in to specific Month." data-position='right'>
						<center><h5><strong>Monthly Progress</strong>(# of Persons)</h5></center>
					</div>
				</div>
				<div class="row">
					<div id="monthrange" class="col-md-12" data-step="10" data-intro="Click on this bar chart to filter by Range of Month(s)." data-position='right'>
						<center><h5><strong>Select Month Range Here</strong></h5></center>
					</div>
				</div>
				</div>
			</div>
			<div class="row">
				<br>
				<div class="col-xs-6">
					<center>
					Produced by Information Management Unit, UNHCR, Lebanon. Design by <small><a href="https://github.com/winaungthu" target="_blank" >Aung Thu Win</a></small>, <a href="mailto:wina@unhcr.org">wina@unhcr.org</a>. <br>
					For more information please contact James Leon-Dufour, <a href="mailto:wina@unhcr.org">leondufo@unhcr.org</a>
					UNHCR thanks all partners for their data and cooperation.
					</center>
				</div>
				<div class="col-xs-6">
					<center>
					<b><font color="red">Credit:</font></b> <small></samll><a href="https://github.com/edouard-legoupil/3W-Dashboard/" target="_blank" >Edouard Legoupil</a></small>,
					<small><a href="https://github.com/dc-js/dc.js" target="_blank" >Gordon Woodhull</a></small>,
					<small><a href="https://github.com/knwin" target="_blank" >Kyaw Naing Win</a></small>, <br>
					<small><a href="http://chimera.labs.oreilly.com/books/1230000000345" target="_blank" >Interactive Data Visualization for the Web by Scott Murray</a></small>
					</center>
				</div>
			</div>
		</div>
	
	<script type="text/javascript" src="../../js/d3_002.js"></script>
	<!--script type="text/javascript" src="js/d3.v3.js"></script -->
    <script type="text/javascript" src="../../js/crossfilter.js"></script>
    <script type="text/javascript" src="../../js/dc.js"></script>
    <script type="text/javascript" src="../../js/d3.tip.min.js"></script>
	<script>
	
	//Prepare to load in GeoJSON data for area
	var width = 360;
	var height = 360;
	//Create SVG element
	var svg = d3.select("#area")
				.append("svg")
				.attr("width", width)
				.attr("height", height)
				.style("stroke-width", "0")
				.style("stroke", "white");
				
	//Load in GeoJSON data for area
	d3.json("../../geojson/lebanon-area-new.geojson", function(json) {
		// create a first guess for the projection
		var center = d3.geo.centroid(json)
		var scale  = 150;
		var offset = [width/2, height/2];
		var projection = d3.geo.mercator().scale(scale).center(center)
			.translate(offset);

		// create the path
		var path = d3.geo.path().projection(projection);

		// using the path determine the bounds of the current map and use 
		// these to determine better values for the scale and translation
		var bounds  = path.bounds(json);
		var hscale  = scale*(width) / (bounds[1][0] - bounds[0][0]); 
		var vscale  = scale*(height - 75)/ (bounds[1][1] - bounds[0][1]); //in (height - 100), the - 100 is a specifically inserted to best view the map of Lebanon. Otherwise the map will be a bit out of bound
		var scale   = (hscale < vscale) ? hscale : vscale;
		var offset  = [width - (bounds[0][0] + bounds[1][0])/2,
							height - (bounds[0][1] + bounds[1][1])/2]; 

		// new projection
		//projection = d3.geo.mercator().center(center)
		//	.scale(scale).translate(offset);
		//	path = path.projection(projection);
		path.projection(d3.geo.mercator().center([38.1,33.5]).scale(9000))

		// add a rectangle to see the bound of the svg
		svg.append("rect").attr('width', width).attr('height', height)
			.style('stroke', 'black').style('fill', 'none');

		svg.selectAll("path").data(json.features).enter().append("path")
			.attr("d", path)
			.style("fill", "white")
			.style("stroke-width", "1")
			.style("stroke", "black")
			
			
	});
	
	//Prepare to load data
	var dataset;
	
	var indicator_chart = dc.rowChart("#indicator");
	var ppg_chart = dc.pieChart("#ppg");
	var area_chart = dc.bubbleOverlay("#area")
		.svg(d3.select("#area svg"));
	var caza_chart = dc.geoChoroplethChart("#caza");
	var funded_chart = dc.pieChart("#funded");
	var rrp6_chart = dc.rowChart("#rrp6");
	var sitetype_chart = dc.rowChart("#sitetype");
	var partner_chart = dc.rowChart("#partner");
	var month_chart = dc.lineChart("#month");
	var monthrange_chart = dc.barChart("#monthrange");

	d3.csv("data/shelter.csv", function(error, dataset) {
		
		var dateFormat = d3.time.format("%d/%m/%Y");
		var numberFormat = d3.format(",f");
		
		dataset.forEach(function (d) {
			d.dd = dateFormat.parse(d.StartDate);
			d.month = d3.time.month(d.dd); // pre-calculate month for better performance
			d.close = +d.close; // coerce to number
			d.open = +d.open;
		});
		
		if (error) {  //If error is not null, something went wrong.
			console.log(error);  //Log the error.
        } else {      //If no error, the file loaded correctly. Yay!
			//console.log(dataset);   //Log the data.
      
		var cf = crossfilter(dataset);
		
		cf.indicator = cf.dimension(function(d) { return d.IndicatorCategory; });
		cf.ppg = cf.dimension(function(d) { return d.PPG; });
		cf.area = cf.dimension(function(d) { return d.Area; });
		cf.caza = cf.dimension(function(d) { return d.CazaCode; });
		cf.partner = cf.dimension(function(d) { return d.Partner; });
		cf.funded = cf.dimension(function(d) { return d.Fundedby; });
		cf.rrp6 = cf.dimension(function(d) { return d.RRP6result; });
		cf.sitetype = cf.dimension(function(d) { return d.SiteType; });
		cf.month = cf.dimension(function (d) {return d.month;});
		
		
		var indicator = cf.indicator.group();
		var ppg = cf.ppg.group();
		var area = cf.area.group();
		var caza = cf.caza.group();
		var partner = cf.partner.group();
		var funded = cf.funded.group();
		var rrp6 = cf.rrp6.group();
		var sitetype = cf.sitetype.group();
		var month = cf.month.group();
		var all = cf.groupAll();
		
		var indicatorByTotal = cf.indicator.group().reduceSum(function (d) { return d.Value;} );
		var ppgByTotal = cf.ppg.group().reduceSum(function (d) { return d.Value;} );
		var areaByTotal = cf.area.group().reduceSum(function (d) { return d.Value;} );
		var cazaByTotal = cf.caza.group().reduceSum(function (d) { return d.Value;} );
		var partnerByTotal = cf.partner.group().reduceSum(function (d) { return d.Value;} );
		var fundedByTotal = cf.funded.group().reduceSum(function (d) { return d.Value;} );
		var rrp6ByTotal = cf.rrp6.group().reduceSum(function (d) { return d.Value;} );
		var sitetypeByTotal = cf.sitetype.group().reduceSum(function (d) { return d.Value;} );
		var monthByTotal = cf.month.group().reduceSum(function (d) { return d.Value;} );
		//var incltotalByTotal = cf.incltotal.group().reduceSum(function (d) { return d.Value; });
		
		function getFiltersValues() {
                var filters = [
                    { name: 'indicator', value: indicator_chart.filters()},
					{ name: 'ppg', value: ppg_chart.filters()},
					{ name: 'funded', value: funded_chart.filters()},
					{ name: 'rrp6', value: rrp6_chart.filters()},
					{ name: 'partner', value: partner_chart.filters()},
					{ name: 'sitetype', value: sitetype_chart.filters()},
					{ name: 'area', value: area_chart.filters()},
					{ name: 'caza', value: caza_chart.filters()}
					];

                var recursiveEncoded = $.param( filters );
                location.hash = recursiveEncoded;
            }
		function initFilters() {
                // Get hash values
                var parseHash = /^#indicator=([A-Za-z0-9,_\-\/\s]*)&ppg=([A-Za-z0-9,_\-\/\s]*)&funded=([A-Za-z0-9,_\-\/\s]*)&rrp6=([A-Za-z0-9,_\-\/\s]*)&partner=([A-Za-z0-9,_\-\/\s]*)&sitetype=([A-Za-z0-9,_\-\/\s]*)&area=([A-Za-z0-9,_\-\/\s]*)&caza=([A-Za-z0-9,_\-\/\s]*)$/;
                var parsed = parseHash.exec(decodeURIComponent(location.hash));
                function filter(chart, rank) {  
                    
                    if (parsed[rank] == "") {
                        chart.filter(null);
                    }
                    else {
                        var filterValues = parsed[rank].split(",");
                        for (var i = 0; i < filterValues.length; i++ ) {
                            chart.filter(filterValues[i]);
                        }
                    }
                }
                if (parsed) {
                    filter(indicator_chart, 1);
					filter(ppg_chart, 2);
					filter(funded_chart, 3);
					filter(rrp6_chart, 4);
					filter(partner_chart, 5);
					filter(sitetype_chart, 6);
					filter(area_chart, 7);
					filter(caza_chart, 8);
                }
            }
		
		    // tooltips for row chart
            var rowTip = d3.tip()
                  .attr('class', 'd3-tip')
                  .offset([-10, 0])
                  .html(function (d) { return "<span style='color: #f0027f'>" +  d.key + "</span> : "  + numberFormat(d.value) + " Individuals"; });

            // tooltips for pie chart
            var pieTip = d3.tip()
                  .attr('class', 'd3-tip')
                  .offset([-10, 0])
                  .html(function (d) { return "<span style='color: #f0027f'>" +  d.data.key + "</span> : "  + numberFormat(d.value) + " Individuals"; });

            // tooltips for bar chart
            var barTip = d3.tip()
                  .attr('class', 'd3-tip')
                  .offset([-10, 0])
                  .html(function (d) { return "<span style='color: #f0027f'>" + d.data.key + "</span> : " + numberFormat(d.value) + " Individuals";});
				  
			// tooltips for bubble chart
            var bubbleTip = d3.tip()
                  .attr('class', 'd3-tip')
                  .offset([-10, 0])
                  .html(function (d) { return "<span style='color: #f0027f'>" + d.key + "</span> : " + numberFormat(d.value) + " Individuals";});
				  
			// tooltips for geoChoropleth chart (there is an error and that's why I blocked it off temporarily)
			/*
            var geoTip = d3.tip()
                  .attr('class', 'd3-tip')
                  .offset([-10, 0])
                  .html(function (d) { return "<span style='color: #f0027f'>" + cazacode2caza[d.key] + "</span> : " + numberFormat(d.value) + " Individuals";});
			*/
			
			indicator_chart.width(400).height(200)
                .dimension(cf.indicator)
                .group(indicatorByTotal)
                .elasticX(true)
                .on("filtered", getFiltersValues)
                .data(function(group) {
                    return group.top(100);
                })
                //.colors(['#ffc000'])
				.colors(['#ffc000'])
                .colorDomain([0,0])
                .colorAccessor(function(d, i){return 1;})
                .xAxis().ticks(4).tickFormat(d3.format("s"));
				
			ppg_chart.width(200).height(175)
                .dimension(cf.ppg)
                .group(ppgByTotal)
                .innerRadius(10)
                .colors(['#ff0000', /* Affected lebanese */
                        '#00ff00', /* Lebanese Returnees */
						'#0000ff', /* Palestanian Refugees from Syria */
						'#ffc000', /* Syrian Refugees */
                        ])
                .colorDomain([0,4])
                .renderLabel(true)
                .colorAccessor(function(d, i){return i%4;})
                .on("filtered", getFiltersValues);
			
			funded_chart.width(200).height(175)
                .dimension(cf.funded)
                .group(fundedByTotal)
                .innerRadius(10)
                .colors(['rgb(195,195,255)', /* Indepedent */
                        'rgb(0,108,169)', /* UNHCR */
						'#0000ff', /* Other 1 */
						'#ffc000', /* Other 2 */
                        ])
                .colorDomain([0,4])
                .renderLabel(true)
                .colorAccessor(function(d, i){return i%4;})
                .on("filtered", getFiltersValues);
			
			rrp6_chart.width(400).height(100)
                .dimension(cf.rrp6)
                .group(rrp6ByTotal)
                .elasticX(true)
                .on("filtered", getFiltersValues)
                .data(function(group) {
                    return group.top(100);
                })
                //.colors(['#ffc000'])
				.colors(['#ffc000'])
                .colorDomain([0,0])
                .colorAccessor(function(d, i){return 1;})
                .xAxis().ticks(4).tickFormat(d3.format("s"));
			
			partner_chart.width(400).height(570)
                .dimension(cf.partner)
                .group(partnerByTotal)
                .elasticX(true)
                .on("filtered", getFiltersValues)
                .data(function(group) {
                    return group.top(200);
                })
                .colors(['#ffc000'])
                .colorDomain([0,0])
                .colorAccessor(function(d, i){return 1;})
                .xAxis().ticks(4).tickFormat(d3.format("s"));
			
			sitetype_chart.width(400).height(150)
                .dimension(cf.sitetype)
                .group(sitetypeByTotal)
                .elasticX(true)
                .on("filtered", getFiltersValues)
                .data(function(group) {
                    return group.top(100);
                })
                //.colors(['#ffc000'])
				.colors(['#ffc000'])
                .colorDomain([0,0])
                .colorAccessor(function(d, i){return 1;})
                .xAxis().ticks(4).tickFormat(d3.format("s"));
			
			area_chart.width(400).height(400)
                .transitionDuration(1000) // (optional) define chart transition duration, :default = 1000
				.dimension(cf.area) // set crossfilter dimension, dimension key should match the name retrieved in geo json layer
				.group(areaByTotal) // set crossfilter group
				.colors(['#ffc000'])
				.colorDomain([0, 0])
				.colorAccessor(function(d, i){return 1;})
				.title(function(d) { return "area: " + d.key + "\nTotal:" + d.value;})
				.r(d3.scale.linear().domain([0, 200000]))
				//.point("Beirut", 151, 176)
				//.point("Bekaa", 241, 186)
				//.point("El Nabatieh", 154, 320)
				//.point("Mount Lebanon", 166, 220)
				//.point("North", 205, 100)
				//.point("South", 100, 331)
				.point("Beirut", 90, 176)
				.point("Bekaa", 190, 150)
				.point("Akkar", 175, 50)
				.point("Tripoli", 135, 90)
				.point("South", 60, 280)
				.on("filtered", getFiltersValues)
				.debug(false);		

			month_chart.width(900).height(270)
				//.renderArea(true)
				.transitionDuration(1000)
				.margins({top: 30, right: 50, bottom: 25, left: 40})
				.dimension(cf.month)
				.mouseZoomable(true)
				// Specify a range chart to link the brush extent of the range with the zoom focue of the current chart.
				.rangeChart(monthrange_chart)
				.x(d3.time.scale().domain([new Date(2014, 0, 1), new Date(2014, 12, 31)]))
				.round(d3.time.month.round)
				.xUnits(d3.time.months)
				//.elasticY(true)
				.renderHorizontalGridLines(true)
				.legend(dc.legend().x(800).y(10).itemHeight(13).gap(5))
				.brushOn(false)
				// Add the base layer of the stack with group. The second parameter specifies a series name for use in the legend
				// The `.valueAccessor` will be used for the base layer
				.group(monthByTotal, "Monthly Progress")
				.valueAccessor(function (d) {
					return d.value;
				})
				.colors(['#ffc000']);
				// stack additional layers with `.stack`. The first paramenter is a new group.
				// The second parameter is the series name. The third is a value accessor.
				//.stack(monthlyMoveGroup, "Monthly Index Move", function (d) {
				//	return d.value;
				//})
				// title can be called by any stack layer.
				//.title(function (d) {
				//	var value = d.value.avg ? d.value.avg : d.value;
				//	if (isNaN(value)) value = 0;
				//	return dateFormat(d.key) + "\n" + numberFormat(value);
				//});
				
			monthrange_chart.width(900)
				.height(40)
				.margins({top: 0, right: 50, bottom: 20, left: 40})
				.dimension(cf.month)
				.group(monthByTotal)
				.centerBar(true)
				.colors(['#ffc000'])
				.gap(2)
				.x(d3.time.scale().domain([new Date(2014, 0, 1), new Date(2014, 12, 31)]))
				.round(d3.time.month.round)
				//.alwaysUseRounding(true)
				.xUnits(d3.time.months);
			monthrange_chart.yAxis().ticks(0);
			
			d3.json("../../geojson/lebanon-caza.geojson", function (cazaJSON) {
				
				 caza_chart.width(360).height(360)
					.dimension(cf.caza)
					.group(cazaByTotal)
					
					//.colors(d3.scale.quantize().range(["#E2F2FF", "#C4E4FF", "#9ED2FF", "#81C5FF", "#6BBAFF", "#51AEFF", "#36A2FF", "#1E96FF", "#0089FF", "#0061B5"]))
					.colors(d3.scale.quantize().range(["#FFFF80",	"#FCE96D", "#FCD75B", "#F7C348", "#F5AF36",	"#E39529", "#C46D1B", "#A64C11", "#872A08",	"#6B0000"]))
						.colorDomain([0, 60000])
						.colorCalculator(function (d) { return d ? caza_chart.colors()(d) : '#ccc'; })
					.overlayGeoJson(cazaJSON.features, "Caza", function (d) { 
						return d.properties.Cada_Code; 
					})
					.projection(d3.geo.mercator().center([38.1,33.5]).scale(9000))
					//path.projection(d3.geo.mercator().center([38.1,33.5]).scale(9000))
					.title(function (d) {
						return "Caza: " + cazacode2caza[d.key] + "\n" + numberFormat(d.value);
					})
					;
					
					//dc.redrawAll();
					dc.renderAll();
					
					/* Customised infobox */
					d3.selectAll("g.row").call(rowTip);
					d3.selectAll("g.row").on('mouseover', rowTip.show)
						.on('mouseout', rowTip.hide);
				
					d3.selectAll(".pie-slice").call(pieTip);
					d3.selectAll(".pie-slice").on('mouseover', pieTip.show)
						.on('mouseout', pieTip.hide);				
						
					d3.selectAll(".node").call(bubbleTip);
					d3.selectAll(".node").on('mouseover', bubbleTip.show)
						.on('mouseout', bubbleTip.hide);
					
					/* There is an error with this code and that's why I blocked it off temporarily
					d3.selectAll(".Caza").call(geoTip);
					d3.selectAll(".Caza").on('mouseover', geoTip.show)
						.on('mouseout', geoTip.hide);
					*/
				
				
			});
			
			dc.dataCount("#count-info")
				.dimension(cf)
				.group(all);
			
			
			//$('#loading').hide();
			$('#dashboard').show();
			
			           			
        }
	});


	</script>	
	
    <script src="../../js/bootstrap.js"></script>
    <!-- Piwik-->
    <script type="text/javascript">
    var pkBaseURL = (("https:" == document.location.protocol) ? "https://data.unhcr.org/piwik/" : "http://data.unhcr.org/piwik/");
    document.write(unescape("%3Cscript src='" + pkBaseURL + "piwik.js' type='text/javascript'%3E%3C/script%3E"));
    </script><script type="text/javascript">
    try {
    var piwikTracker = Piwik.getTracker(pkBaseURL + "piwik.php", 21);
    piwikTracker.trackPageView();
    piwikTracker.enableLinkTracking();
    } catch( err ) {}
    </script><noscript><p><img src="http://data.unhcr.org/piwik/piwik.php?idsite=21" style="border:0" alt="" /></p></noscript>
    <!-- End Piwik Tracking Code -->
	
	</body>
</html>