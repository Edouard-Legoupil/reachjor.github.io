<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title></title>
    <!-- Bootstrap -->  
    <link rel="stylesheet" type="text/css" href="css/dc.css"/>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css"/>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style>
		#map {
		width: 100%;
		stroke: #777;
		stroke-dasharray: 2,2;
		stroke-linejoin: round;
		opacity:1;
		position: relative;
	}
    </style>
</head>
<body  style="background:#CFCBBE">
  
<nav class="navbar navbar-default" role="navigation">
  <div class="container-fluid">
    <!-- Brand and toggle get grouped for better mobile display -->
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="#">Jordan - Al Zaatari Camp population count</a>
    </div>
    <!-- Collect the nav links, forms, and other content for toggling -->
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li><a href="#"> </a></li>
        <li ><a class="reset btn btn-primary btn-sm" id="reset" href="#">Reset All</a></li>
		<li ><a class="reset btn btn-primary btn-sm" id="data" href="data/JOR_ZAA_populationCount.xlsx">Download the Data</a></li>
		 <li style="top:3px"><img name="onetidHeadbnnr0" src="img/REACH.jpg" width="100" height="40"  widhtalt="Page d'accueil" style="border-width:0px;"><li>
      </ul>
    </div><!-- /.navbar-collapse -->
  </div><!-- /.container-fluid -->
</nav>
<body>
  <div class="container">
    <div class="row">
	  <div class="col-md-6" ><p></p>
			<div id ="map" class="map"><h5>Al Za'atari refugee camp</h5>
			
			</div>
			
			<div id ="date"class="dc-chart"><h5>Date of Arrival</h5></div>
	  </div>
	  <div class="col-md-3"> 
        <div id="district"class="dc-chart"><h5>District</h5></div>
		<div id="gender"class="dc-chart"><h5>Gender</h5></div>
      </div>
      <div class="col-md-3">
		<div id ="age"class="dc-chart"><h5>Ages</h5></div>
		<div id="shelter"class="dc-chart"><h5>Shelter</h5></div>
	</div>
	 
      
    </div>

  </div> <!-- /container -->
</br>
    <!--<div id="reachbar"></div>-->
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script>
 </body>

<!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
<!--<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>-->
<!-- Include all compiled plugins (below), or include individual files as needed -->
<script src="js/bootstrap.min.js"></script>
<script src="js/jquery.js"></script>
<script type="text/javascript" src="js/d3.js"></script>
<script type="text/javascript" src="js/crossfilter.js"></script>
<script type="text/javascript" src="js/dc.js"></script>
<script type="text/javascript">

var groupname = "marker-select";

var mapChart            = dc.geoChoroplethChart("#map",groupname);
    DistChart           = dc.rowChart("#district",groupname),
    genderChart         = dc.rowChart("#gender",groupname),
    dateChart           = dc.lineChart("#date", groupname),
    ageChart            = dc.rowChart("#age", groupname),
	shelterChart        = dc.rowChart("#shelter",groupname);

d3.csv("data/pop_count.csv", function(error, experiments) {
  var dateFormat = d3.time.format("%Y/%m");
experiments.forEach(function (d) {
d.dd  = dateFormat.parse(d.arriv);
});
var ndx                  = crossfilter(experiments),
      SubOffMapDim       = ndx.dimension(function(d) {return d.dist;}),
      SubOffMapGroup     = SubOffMapDim.group().reduceCount(),
      DistDimension      = ndx.dimension(function(d) {return d.dist;}),
      DistGroup          = DistDimension.group(),
      GenderDim          = ndx.dimension(function(d) {return d.gender;}),
      GenderGroup        = GenderDim.group().reduceCount(),
	  ShelterDim         = ndx.dimension(function(d) {return d.shelter;}),
      ShelterGroup       = ShelterDim.group().reduceCount(),
      dateDimension      = ndx.dimension(function(d) {return d.dd ;}),
      dateGroup          = dateDimension.group(),
      AgeDim             = ndx.dimension(function(d) {return d.age_brakets;}),
	  all                = ndx.groupAll(),
      AgeGroup           = AgeDim.group().reduceCount();
      
d3.json("map/district.json", function (statesJson) {

  mapChart.width(700)
          .height(400)
          .dimension(SubOffMapDim)
          .group(SubOffMapGroup)
		  // .colors(d3.scale.quantize().range(["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#0c2c84"]))
          .colors(d3.scale.quantize().range(["#ededed","#DEDEDE","#D1D1D1","#DEB4B4","#F08B8D","#E54344"]))
          //.colors(d3.scale.quantize().range(["#ffffcc", "#ffeda0", "#fed976", "#feb24c", "#fd8d3c", "#fc4e2a", "#e31a1c", "#bd0026", "#800026", "#67000d"]))
          .colorDomain([0, 10000])
          .colorCalculator(function (d) { return d ? mapChart.colors()(d) : '#ccc'; })
          .overlayGeoJson(statesJson.features, "state", function (d) {
              return d.properties.dist;
          })
		  .renderLabel(true)
		  .label(function(p) {return p.dist;})		
          .projection(d3.geo.mercator().center([36.35,32.29]).scale(700000).rotate([0,0,0]));
		  

  DistChart.width(200).height(350)
          .dimension(DistDimension)
          .group(DistGroup)
         // .stack(governoratesByHousehold)
          .elasticX(true)
          .renderLabel(true)
          //.ordering(function (p) { return -p.value;})
          .colors(['#58585A'])
          .colorDomain([0,0])
          .colorAccessor(function(d, i){return 1;})
          .xAxis().ticks(4).tickFormat(d3.format("s"));

  genderChart
          .width(200)
          .height(150)
          //.slicesCap(7)
          //.colors(['#EE5859'])
          //.colorDomain([0,0])
		  .elasticX(true)
          .ordering(function (p) { return -p.value;})
          .dimension(GenderDim)
          .group(GenderGroup)
		  .colors(['#EE5859'])
          .colorDomain([0,0])
          .colorAccessor(function(d, i){return 1;})
          .xAxis().ticks(4).tickFormat(d3.format("s"));
		  
   shelterChart
          .width(200)
          .height(150)
          //.slicesCap(7)
          //.colors(['#EE5859'])
          //.colorDomain([0,0])
		  .elasticX(true)
          .ordering(function (p) { return -p.value;})
          .dimension(ShelterDim)
          .group(ShelterGroup)
		  .colors(['#58585A'])
          .colorDomain([0,0])
          .colorAccessor(function(d, i){return 1;})
          .xAxis().ticks(4).tickFormat(d3.format("s"));
		  
  dateChart
          .width(600)
          .height(200)
          //.margins({top: 10, right: 50, bottom: 30, left: 60})
          .dimension(dateDimension)
          .group(dateGroup)
          .x(d3.time.scale().domain([new Date(2012, 1, 01), new Date(2014, 12, 31)]))
          .renderHorizontalGridLines(true)
          .elasticY(true)
          .renderArea(true)
          .brushOn(true)
          .renderDataPoints(false)
          .xAxis().ticks(10);

  ageChart.width(250).height(350)
          .dimension(AgeDim)
          .group(AgeGroup)
         // .stack(governoratesByHousehold)
          .elasticX(true)
          .renderLabel(true)
          //.slicesCap(7)
          .ordering(function (p) { return p.value;})
          .colors(['#FFAA00'])
          .colorDomain([0,0])
          .colorAccessor(function(d, i){return 1;})
          .xAxis().ticks(4).tickFormat(d3.format("s"));

/*dc.dataTable("#dc-table-graph")
    .width(960).height(800)
    .dimension(governorates)
    .group(function(d) { return "Sites Table" })
    .size(30)
    .columns([
      function(d) { return d.governorate; },
      function(d) { return d.district; },
      function(d) { return d.household; },
      function(d) { return d.individual; }
    ])
    .sortBy(function(d){ return d.governorate; })map
    .sortBy(function(d){ return d.governorate; })
    .order(d3.ascending)
    .renderlet(function (table) { table.selectAll(".dc-table-group").classed("info", true); });
*/
$('#reset').on('click', function (){
  dc.filterAll(groupname);
  //dc.renderAll(groupname);
  dc.redrawAll(groupname);
  return false;
})

//  dc.renderAll();
  dc.renderAll(groupname);
  });

});

</script>

</body>
</html>
